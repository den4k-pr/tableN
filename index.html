<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/nullStyle.css">
    <link rel="icon" href="./img/favicon.png" type="image/png">
    <link rel="stylesheet" href="css/main.css">
    <title>Ho-ho-hold That Stretch!</title>

</head>

<body>

    <img src="./img/logo.svg" class="logo" alt="logo">
    <div class="popup">
        <div class="popup__content">
            <button class="close"><img src="./img/close.svg" alt="close"></button>
            <h2 class="popup__content-title"></h2>
            <p class="popup__content-text"></p>
            <a href="#" target="_blank" class="download"></a>
        </div>
    </div>

    <div class="calendar-grid">
        <div class="item g m">01</div>
        <div class="item r w-2">02</div>
        <div class="item b m">03</div>

        <div class="item r h-2">04</div>
        <div class="item b m">05</div>
        <div class="item r w-2">06</div>

        <div class="item g m">07</div>
        <div class="item r m">08</div>
        <div class="item b h-2">09</div>
        <div class="item b m">10</div>
        <div class="item g w-2">11</div>

        <div class="item r m">12</div>
        <div class="item b m">13</div>
        <div class="item r m">14</div>
        <div class="item g m">15</div>

        <div class="item g w-2">16</div>
        <div class="item b h-2">17</div>
        <div class="item r h-2">18</div>

        <div class="item r h-2">20</div>
        <div class="item g m">19</div>

        <div class="item b m">21</div>
        <div class="item r m">22</div>
        <div class="item g m">23</div>

        <div class="item g w-2" style="z-index: 3;">24</div>
        <div class="item r w-2" style="z-index: 2;"><img src="./img/dm.svg" class="dm" alt="dm" />25</div>

        <div class="item r m">26</div>
        <div class="item b w-2">27</div>

        <div class="item h-2">30</div>

        <div class="item w-2">28</div>
        <div class="item m">29</div>
    </div>


</body>
<script>
    const popupData = [
        {
            day: 1,
            bg: "./img/popup_fon-1.png",
            title: "Hey hey! That‚Äôs the first day!",
            text: "Your first full body + glutes training is here.",
            link: "https://example.com/day1",
            linkText: "Start now"
        },
        {
            day: 2,
            bg: "./img/popup_fon-2.png",
            title: "Day 2 is here!",
            text: "Today is about mobility and stretching.",
            link: "https://example.com/day2",
            linkText: "Start The Flow"
        },

        {
            day: 3,
            bg: "./img/popup_fon-2.png",
            title: "Day 2 is here!",
            text: "Today is about mobility and stretching.",
            link: "https://example.com/day2",
            linkText: "Start The Flow"
        },
    ];

    document.addEventListener("DOMContentLoaded", () => {

        const popup = document.querySelector(".popup");
        const popupContent = popup.querySelector(".popup__content");
        const popupTitle = popup.querySelector(".popup__content-title");
        const popupText = popup.querySelector(".popup__content-text");
        const popupLink = popup.querySelector(".download");

        const items = document.querySelectorAll(".calendar-grid .item");

        // === –î–∞–Ω—ñ –¥–ª—è popup (title, —Ç–µ–∫—Å—Ç, —Ñ–æ–Ω, –ø–æ—Å–∏–ª–∞–Ω–Ω—è) ===
        const popupData = [
            { day: 1, bg: "./img/popup_fon-1.png", title: "Lets<br>start<br>with <br>day 1!", text: " Before we jump into the fun, let‚Äôs set the foundation‚ú®<br> Use it daily to keep your routines simple, joyful, and stress-free", link: "./tracker.pdf", linkText: "Download a Tracker", download: true  },
            { day: 2, bg: "./img/popup_fon-2.png", title: "Hey hey!<br>That‚Äôs the<br>second day!", text: "Your first full body + glutes<br>training is here. <br>Let's move and set<br>strength foundation!", link: "https://zubalenok.kwiga.com/o/5xVhS9IbkWIw", linkText: "Start now" },
            { day: 3, bg: "./img/popup_fon-3.png", title: "Day 3 is here!", text: "YOU'RE BACK! üí™ <br>That's consistency. Let's get into<br>Mobility Flow Today!", link: "https://zubalenok.kwiga.com/o/dfL34Zzrc4Wc", linkText: "Start The Flow!" },
            { day: 4, bg: "./img/popup_fon-4.png", title: "Welcome to day 4!", text: "Surprise! Today's gift isn't <br>a workout ‚Äî it's<br>Your Personal Nutrition<br>Guide!<br>Smart, simple tips to feel<br>amazing through the<br>holidays.", link: "https://zubalenok.kwiga.com/o/c7d7WFdEFLxF", linkText: " Check <br>Your Lesson!" },
            { day: 5, bg: "./img/popup_fon-5.png", title: "Advent Day 5:<br>Time for <br>Back Mobility!", text: "", link: "https://zubalenok.kwiga.com/o/c7d7WFdEFLxF", linkText: " Check it Out!" },
            { day: 6, bg: "./img/popup_fon-6.png", title: "Keep going! <br>Day 6 <br>is open!!", text: "Let‚Äôs train smart, feel strong,<br>and stay consistent.", link: "https://zubalenok.kwiga.com/o/F1loeH2vmSbo", linkText: "Unlock Your<br>Body Strength" },
        ];

        // === –õ–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –¥–Ω—ñ–≤ ===
        let openedDays = JSON.parse(localStorage.getItem("openedDays")) || [];
        let dailyOpened = JSON.parse(localStorage.getItem("dailyOpened")) || [];
        let limitTimestamp = localStorage.getItem("limitTimestamp");

        // === –°–∫–∏–¥–∞–Ω–Ω—è –ª—ñ–º—ñ—Ç—É —â–æ–¥–Ω—è ===
        function checkDailyReset() {
            if (!limitTimestamp) return;
            const now = Date.now();
            const oneDay = 24 * 60 * 60 * 1000;
            if (now - limitTimestamp >= oneDay) {
                dailyOpened = [];
                localStorage.setItem("dailyOpened", JSON.stringify([]));
                limitTimestamp = Date.now();
                localStorage.setItem("limitTimestamp", limitTimestamp);
            }
        }
        checkDailyReset();

        // === –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É –¥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è ===
        items.forEach(item => {
            const day = parseInt(item.textContent.replace(/\D/g, ""), 10);
            item.style.opacity = openedDays.includes(day) ? "1" : "0.5";
        });

        // === –í—ñ–¥–∫—Ä–∏—Ç—Ç—è popup ===
       function openPopup(dayNumber) {
    const data = popupData.find(d => d.day === dayNumber);
    if (!data) return;

    const img = new Image();
    img.src = data.bg;

    img.onload = () => {
        // –®—Ç—É—á–Ω–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º
        setTimeout(() => {
            popup.className = `popup day-${data.day}`;
            popupContent.style.backgroundImage = `url('${data.bg}')`;
            popupTitle.innerHTML = data.title; // –¥–æ–∑–≤–æ–ª—è—î <br>
            popupText.innerHTML = data.text;   // –¥–æ–∑–≤–æ–ª—è—î <br>
            popupLink.href = data.link;
            popupLink.innerHTML = data.linkText; // —Ç–µ–ø–µ—Ä <br> –ø—Ä–∞—Ü—é—î —ñ —Ç—É—Ç

            if (data.download) {
                popupLink.setAttribute("download", "");
            } else {
                popupLink.removeAttribute("download");
            }
            popup.classList.add("active");
        }, 400); // 400 –º—Å –∑–∞—Ç—Ä–∏–º–∫–∞
    };

    img.onerror = () => {
        console.error("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è:", data.bg);
        setTimeout(() => {
            popup.className = `popup day-${data.day}`;
            popupTitle.innerHTML = data.title;
            popupText.innerHTML = data.text;
            popupLink.href = data.link;
            popupLink.innerHTML = data.linkText;

            popup.classList.add("active");
        }, 400);
    };
}



        function closePopup() {
            popup.classList.remove("active");
        }

        // === –ö–ª—ñ–∫ –ø–æ –¥–Ω—é –∫–∞–ª–µ–Ω–¥–∞—Ä—è ===
        items.forEach(item => {
            item.addEventListener("click", () => {
                const day = parseInt(item.textContent.replace(/\D/g, ""), 10);
                const alreadyOpened = openedDays.includes(day);

                if (!alreadyOpened) {
                    if (dailyOpened.length === 0) {
                        limitTimestamp = Date.now();
                        localStorage.setItem("limitTimestamp", limitTimestamp);
                    }

                    if (dailyOpened.length >= 2) {
                        alert("You can open only 2 items per 24 hours!");
                        return;
                    }

                    openedDays.push(day);
                    localStorage.setItem("openedDays", JSON.stringify(openedDays));

                    dailyOpened.push(day);
                    localStorage.setItem("dailyOpened", JSON.stringify(dailyOpened));

                    item.style.opacity = "1";
                }

                openPopup(day);
            });
        });

        // === –ó–∞–∫—Ä–∏—Ç—Ç—è popup ===
        popup.querySelector(".close").addEventListener("click", closePopup);
        popup.addEventListener("click", e => {
            if (!popupContent.contains(e.target)) closePopup();
        });
        document.addEventListener("keydown", e => {
            if (e.key === "Escape") closePopup();
        });

        // === –î–æ–¥–∞—Ç–∫–æ–≤–æ: –Ω–µ–≤–µ–ª–∏–∫–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –∫–Ω–æ–ø–æ–∫ ===
        let animationStopped = false;
        function runButtonIntroAnimation() {
            const buttons = Array.from(items);
            let index = 0;
            function animateNext() {
                if (animationStopped) return;
                const btn = buttons[index];
                btn.style.transition = "transform 0.25s ease";
                btn.style.transform = "scale(1.02)";
                setTimeout(() => {
                    btn.style.transform = "scale(1)";
                    setTimeout(() => {
                        index++;
                        if (index >= buttons.length) index = 0;
                        animateNext();
                    }, 120);
                }, 250);
            }
            animateNext();
        }
        runButtonIntroAnimation();
        items.forEach(btn => {
            btn.addEventListener("click", () => animationStopped = true, { once: true });
        });

    });
</script>



</html>